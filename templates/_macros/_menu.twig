{# public macro for displaying menu items #}
{% macro showMenuItems(cat = null) %}
{% import _self as self %}

    {% if cat is null %}
        {% set foodItems = craft.entries().section('menu').all() %}
        {% set products = craft.products.type('supplies').limit(10).all() %}
    {% else %}
        {% set foodItems = craft.entries().section('menu').relatedTo(cat) %}
        {% set menuItems = craft.products.type('menuItems').relatedTo(cat) %}
    {% endif %}

    {% for item in menuItems.all() %}
        {# get variant for product item #}
        {% set variant = item.defaultVariant %}

        <div class="FoodItem">
            <div class="FoodItem-info"> 
                <h5 class="FoodItem-title">{{ item.title }}</h5>
                <p>{{ item.fiDescription }}</p>
                <p class="FoodItem-price">{{ variant.price | currency('USD') }}</p>

                <form method="POST">
                    <input type="hidden" name="action" value="commerce/cart/update-cart">
                    <input type="hidden" name="cartUpdatedNotice" value="Added {{ item.title }} to the cart.">
                    {# {{ redirectInput('/menu2') }} #} 
                    {{ csrfInput() }}
                    <input type="hidden" name="qty" value="1">
                    <input type="hidden" name="purchasableId" value="{{ variant.id }}">
                    
                        <input class="button radius" type="submit" value="Add to Menu">                    

                </form>

            </div>
            {% set img = item.fiImage.one() %}
            <span class="FoodItem-image" style="background-image: url({{ img.url }});"></span>
        </div>
    {% endfor %}

{% endmacro showMenuItems %}

{% macro showCart() %}
{% import _self as self %}

{% set cart = craft.commerce.carts.cart %}

    {% if cart.lineItems | length %}
        <form method="post">
            <input type="hidden" name="action"
                    value="commerce/cart/update-cart">
            <input type="hidden" name="cartUpdatedNotice"
                    value="Updated line items.">
            {# {{ redirectInput('/store/cart') }} #}
            {{ csrfInput() }}
    
            <div class="FoodMenu-choices">
                {# show items in cart #}
                {% for item in cart.lineItems %}
                <div class="FoodMenu-item">
                    <p class="name">{{ item.description }}</p>
                    <p class="price">{{ item.price | currency(cart.currency) }}</p>
                    <p class="remove jsRemoveLineItem" data-line-item-id="{{ item.id }}" title="Remove">X</p>
                </div>
                {% endfor %}

                {# show totals #}
                <hr class="FoodMenu-seperator">
                <div class="FoodMenu-total">
                    <p class="name">Total: </p>
                    <p class="price">{{ cart.totalPrice | currency(cart.currency) }}</p>
                    <p class="remove" title="Remove">&nbsp;</p>
                </div>
            </div>

            <span class="FoodItem-button button"><a href="/checkout">Checkout</a></span>


        </form>


    {% else %}
        <form method="post">
            <div class="FoodMenu-item">
                <p>You have no menu items selected. Please make a selection to get started.</p>
            </div>
        </form>
    {% endif %}

{% endmacro showCart %}
